<!DOCTYPE html>
<html>
<head>
<title>Special</title>
</head>
<body class="lift:content_id=main">
	<div id="main" class="lift:surround?with=default;at=content">
		<script class="lift:head" id="composeJS" src="/js/compose-post.js"
			type="text/javascript"></script>
		<script class="lift:head"
			src="http://cdn.jquerytools.org/1.2.7/form/jquery.tools.min.js"></script>
		<!-- Code Mirror Init-->
		<link class="lift:head" rel="stylesheet"
			href="/codemirror/theme/eclipse.css" />
		<script class="lift:head" src="../codemirror/lib/codemirror.js"></script>
		<link class="lift:head" rel="stylesheet"
			href="/codemirror/lib/codemirror.css">
		<script class="lift:head" src="/codemirror/mode/clike/clike.js"></script>
		<script class="lift:head" src="/codemirror/lib/util/searchcursor.js"></script>
		<script class="lift:head"
			src="/codemirror/lib/util/match-highlighter.js"></script>
		<script class="lift:head" src="/codemirror/lib/util/loadmode.js"></script>
		<link class="lift:head" rel="stylesheet"
			href="/CSS/Default/codemirror_default.css">
		<!-- Code Mirror Init End-->
		<!-- Aloha Editor Init-->

		<link rel="stylesheet" href="/aloha/css/aloha.css" type="text/css">
		<script class="lift:head" src="/aloha/lib/require.js"></script>
		<!-- 		<script class="lift:head" src="/aloha/lib/vendor/jquery-1.7.2.js"></script> -->
		<script class="lift:head" type="text/javascript">
			var editorCount = 3;
			if (window.Aloha === undefined || window.Aloha === null) {
				var Aloha = window.Aloha = {};
			}

			Aloha.settings = {
				sidebar : {
					disabled : true
				},
				plugins : {
					block : {
						defaults : {
							'.default-block' : {},
							'.columnBlock' : {
								'aloha-block-type' : 'ColumnBlock'
							},
							'.uneditableColumnBlock' : {
								'aloha-block-type' : 'UneditableColumnBlock'
							},
							'.product-teaser' : {
								'aloha-block-type' : 'ProductTeaserBlock'
							},
							'.company' : {
								'aloha-block-type' : 'CompanyBlock'
							},
							'.imageBlock' : {
								'aloha-block-type' : 'ImageBlock'
							},
							'.editableImageBlock' : {
								'aloha-block-type' : 'EditableImageBlock'
							},
							'.news-block' : {
								'aloha-block-type' : 'NewsBlock'
							},
							'.sortable-news-block' : {
								'aloha-block-type' : 'SortableNewsBlock'
							},
							'.editable-product-teaser' : {
								'aloha-block-type' : 'EditableProductTeaserBlock'
							}
						}
					}
				}
			}
		</script>
		<script class="lift:head" src="/aloha/lib/aloha-full.js"
			data-aloha-plugins="common/ui,
								common/format,
		                        common/table,
		                        common/list,
		                        common/link,
		                        common/highlighteditables,
		                        common/block,
		                        common/undo,
		                        common/image,
		                        common/contenthandler,
		                        common/paste,
		                        common/commands,
		                        common/abbr,
		                        common/align,
		                        common/horizontalruler,
		                        extra/htmlsource">
			
		</script>
		<script type="text/javascript">
			window.codeEditors = new Object();
			Aloha.ready(function() {

				// Make #content editable once Aloha is loaded and ready.
				Aloha.jQuery('.WYSIWYG-fields').aloha();

			});
			$(".field-delete").click(function() {
				deleteParentElement(this);
			});
		</script>
		<!-- 	<style class="lift:head">
    #sortable { list-style-type: none; margin: 0; padding: 0; width: 60%; }
    #sortable li { margin: 0 3px 3px 3px; padding: 0.4em; padding-left: 1.5em; font-size: 1.4em; height: 18px; }
    #sortable li span { position: absolute; margin-left: -1.3em; }
    </style> -->
		<script class="lift:head">
			$(function() {

				$("#editor-sort").sortable({
					handle : '.handle',
					cancel : ':input,button,.contenteditable',
					start : function(e, ui) {
						ui.placeholder.height(ui.item.height());
					}
				});

			});
		</script>
		<!-- Aloha Editor Init End-->

		<button id="btnAddHTML">add html</button>
		<button id="btnAddCode">add code</button>
		<button id="btnDel">remove last</button>
		<p>
			<select id="modeSelect">
				<option value="application/x-aspx" mode="htmlembedded">ASP.Net</option>
				<option value="text/x-csrc" mode="clike">C</option>
				<option value="text/x-c++src" mode="clike">C++</option>
				<option value="text/x-csharp" mode="clike">C#</option>
				<option value="text/x-clojure" mode="clojure">Clogjure</option>
				<option value="text/x-coffeescript" mode="coffeescript">Coffe
					Script</option>
				<option value="text/x-common-lisp" mode="commonlisp">Common
					Lisp</option>
				<option value="application/x-ejs" mode="htmlembedded">Embedded
					Javascript</option>
				<option value="text/x-erlang" mode="erlang">Erlang</option>
				<option value="text/x-go" mode="go">Go</option>
				<option value="text/x-groovy" mode="groovy">Groovy</option>
				<option value="text/x-haskell" mode="haskell">Haskell</option>
				<option value="text/x-haxe" mode="haxe">Haxe</option>
				<option value="text/html" mode="htmlmixed">HTML</option>
				<option value="text/x-" mode="">Java</option>
				<option value="text/x-" mode="">JavaScript</option>
				<option value="application/x-jsp" mode="htmlembedded">JSP</option>
				<option value="text/x-" mode="">Jinja2</option>
				<option value="text/x-" mode="">LESS</option>
				<option value="text/x-" mode="">Lua</option>
				<option value="text/x-" mode="">Markdown</option>
				<option value="text/x-mysql" mode="mysql">MySQL</option>
				<option value="text/x-" mode="">NTriples</option>
				<option value="text/x-" mode="">OCaml</option>
				<option value="text/x-" mode="">Pascal</option>
				<option value="text/x-" mode="">Perl</option>
				<option value="text/x-" mode="">PHP</option>
				<option value="text/x-" mode="">Pig Latin</option>
				<option value="text/x-" mode="">PL/SQL</option>
				<option value="text/x-" mode="">Properties files</option>
				<option value="text/x-" mode="">Python</option>
				<option value="text/x-" mode="">R</option>
				<option value="text/x-" mode="">reStructuredText</option>
				<option value="text/x-" mode="">Ruby</option>
				<option value="text/x-" mode="">Rust</option>
				<option value="text/x-" mode="">Scala</option>
				<option value="text/x-" mode="">Scheme</option>
				<option value="text/x-" mode="">Shell</option>
				<option value="text/x-" mode="">Sieve</option>
				<option value="text/x-" mode="">Smalltalk</option>
				<option value="text/x-" mode="">Smarty</option>
				<option value="text/x-" mode="">SPARQL</option>
				<option value="text/x-" mode="">sTeX, LaTeX</option>
				<option value="text/x-" mode="">Tiddlywiki</option>
				<option value="text/x-" mode="">Tiki wiki</option>
				<option value="text/x-" mode="">VB.NET</option>
				<option value="text/x-" mode="">VBScript</option>
				<option value="text/x-" mode="">Velocity</option>
				<option value="text/x-" mode="">Verilog</option>
				<option value="text/x-" mode="">XML</option>
				<option value="text/x-" mode="">XQuery</option>
				<option value="text/x-" mode="">YAML</option>
			</select>
			<button type="button" onclick="change()">change mode</button>
		</p>
		<div id="composer-area" class="sortable">

			<!-- <div class="editable-area sortable-area">
				<h1>This is a empty post!</h1>
			</div> -->

			<!-- Form for the whole post -->
			<form class="lift:form.ajax" action="#">
				<div class="lift:post_form" id="editor_form_wrapper">
					<div id="editor-sort">
						<br>
						<h2>
							<input type="text" id="Text1" required="required"
								class="field-content title-field" name="title"
								placeholder="Post Title"></input>
						</h2>
						<br> <br>
						<div class="sortable-item">
							<div class="handle"></div>

							<button class="field-delete" onclick="deleteParentElement(this)"></button>
							<div id="Text2" class="field-content WYSIWYG-fields"
								contenteditable="true">
								<h3>Header</h3>
							</div>
						</div>
						<div id="Text3" class="sortable-item">
							<div class="handle"></div>
							<button class="field-delete" onclick="deleteParentElement(this)"></button>
							<div class="field-content code-block-fields">
								<textarea id="textArea3">
	import snippet.fun._
	
	class ReplaceMe extends SomeCode{
	    def click = {
	    	this.text.remove
	    }    
	}
							</textarea>
							</div>
						</div>
					</div>
					<div>
						<button id="next" value="Submit" type="button" class="btn">
							<Lift:Loc>Finish</Lift:Loc>
						</button>
					</div>
				</div>
			</form>
			<div data-lift="post_form.sendToServer">
				<script id="sendToServer"></script>
				<script id="initDynamic"></script>
			</div>
		</div>
		<script type="text/javascript">
			CodeMirror.modeURL = "../codemirror/mode/%N/%N.js";
			var modeSelect = document.getElementById("modeSelect");
			var modeInput = document.getElementById("mode");
			var modeFileInput = document.getElementById("modeFile");

			//Setup the first Code editor
			var postTextArea = document.getElementById("textArea3");
			var editor = CodeMirror.fromTextArea(postTextArea, {
				lineNumbers : true,
				mode : "text/x-scala",
				lineWrapping : "wrap",
				onCursorActivity : function() {
					editor.matchHighlight("CodeMirror-matchhighlight");
				}
			});
			window.codeEditors["textArea3"] = editor;

			function change() {
				editor.setOption("mode", modeSelect.value);
				CodeMirror.autoLoadMode(editor,
						$('option:selected', modeSelect).attr('mode'));
			}
			function addPage() {
				var $ = Aloha.jQuery;
				$('#composer-area').append(
						"<br></br><div class=\"editable\"></div>");
				Aloha.jQuery('.editable').mahalo();
				Aloha.jQuery('.editable').aloha();
			}
			function addCode() {
				var composerArea = document.getElementById("composer-area");
				var myCodeMirror = CodeMirror(composerArea, {
					lineNumbers : true,
					value : "",
					mode : "text/x-scala"
				});
			}
			function deleteParentElement(n) {
				n.parentNode.parentNode.removeChild(n.parentNode);
			}
		</script>
	</div>
</body>
</html>
